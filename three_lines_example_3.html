<!DOCTYPE html>
<html lang="en">
	<head>
		<title>lines 3</title>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
		<title>My first three.js app</title>

		<style type="text/css">
			body {
						background-color: #000;
						margin: 0px;
						overflow: hidden;
					}
				#info {
				position: absolute;
				color: #ffffff;
				top: 0px;
				width: 100%;
				padding: 5px;
				font-family:Monospace;
				font-size:13px;
				text-align:center;
			}
			a {
				color: #fff;
			}
		</style>
</head>
<body>
<div id="container"></div>

<div id="info"><a href="https://threejs.org" target="_blank">three.js</a> - fat lines</div>

<script src="js/three.js-master/myThree/three.min.js"></script>
<script src="js/three.js-master/myThree/WebGL.js"></script>
<script src="js/three.js-master/myThree/OrbitControls.js"></script>

<script src="js/three.js-master/myThree/LineSegmentsGeometry.js"></script>
<script src="js/three.js-master/myThree/LineGeometry.js"></script>

<script src="js/three.js-master/myThree/LineMaterial.js"></script>
<script src="js/three.js-master/myThree/LineSegments2.js"></script>
<script src="js/three.js-master/myThree/Line2.js"></script>

<script src="js/d3.v3.min.js"></script>

<script>

if ( WEBGL.isWebGLAvailable() === false ) {

				document.body.appendChild( WEBGL.getWebGLErrorMessage() );

	}

var renderer,scene, camera, controls;
var material, material2;
var line,line2;

function colour_convert(c){

	switch (c) {
	  case 0: //red
	    //return {'r':1,'g':0,'b':0};
	    return new THREE.Color(0xff0000);
	    break;
	  case 1: // green
	  	//return {'r':0,'g':1,'b':0};
	  	return new THREE.Color(0x00ff00);
	  	break;
	  case 2: //blue
	  	//return {'r':0,'g':0,'b':1};
	  	return new THREE.Color(0x0000ff);
	}
};

d3.json('json_files/giacomo_18Mar19_0.json',function(data) {


			var data_test = [{'x':2,'y':3,'z':0,'c':2},{'x':2,'y':4,'z':4,'c':0},{'x':2,'y':2,'z':2,'c':1},{'x':0,'y':0,'z':0,'c':2}];
			
			console.log(data[0])
			init(data);
			animate();
	});

function init(realData){	

	/*
		orientation
		web interface
		all data processed
		upload
		flat finder

		AxesHelper
		An axis object to visualize the 3 axes in a simple way.
		The X axis is red. The Y axis is green. The Z axis is blue.
	*/

	renderer = new THREE.WebGLRenderer({ antialias: true });
	renderer.setClearColor( 0x000000 ,0.0); //0xffffff
	renderer.setPixelRatio( window.devicePixelRatio );
	renderer.setSize( window.innerWidth, window.innerHeight );
	document.body.appendChild( renderer.domElement );


	scene = new THREE.Scene();

	camera = new THREE.PerspectiveCamera( 40, window.innerWidth / window.innerHeight, 1, 1000 );
	camera.position.set( 10, 10, 10 );

	controls = new THREE.OrbitControls( camera ,renderer.domElement );
	controls.minDistance = 1;
	controls.maxDistance = 1000;


	var vectors= [];
	var colors= [];
	var positions=[];
	//var colour_code = new THREE.Color();
	var colourz=[];
	var scale = 4;

	// var points_vectors=[];
	// points_vectors.push(new THREE.Vector3(1,2,3));
	// points_vectors.push(new THREE.Vector3(1,1,1));
	// points_vectors.push(new THREE.Vector3(0,0,0));
	// var color = new THREE.Color();

	for(var i = 0; i<realData.length;i++){
	//for(var i = 0; i<points_vectors.length;i++){


					var v_point = new THREE.Vector3(realData[i].x,realData[i].z,realData[i].y);
					vectors.push(v_point);
					var colour_code = colour_convert(realData[i].c);

					if(colour_code == undefined){
						console.log(realData[i]);
					}
					console.log(colour_code);
					colors.push(colour_code);

					//var point = points_vectors[i];
					// vectors.push(point);
					// positions.push( point.x *sca, point.y*20, point.z*20 );


					//color.setHSL( 0.8, 1.0/i, 0.5 );
					//colors.push( color.r, color.g, color.b );
					//colors.push(color);
		
					var point = v_point;
					positions.push(point.x *scale, point.y *scale, point.z*scale);



					var col = colour_code;
					colourz.push(col.r,col.g,col.b);

	}

	console.log(realData.length);

	// add points in an arbitrary shape
	var geometry = new THREE.Geometry();
	geometry.vertices = vectors;
	geometry.colors = colors;

	//geometry.

	material = new THREE.LineBasicMaterial( { linewidth: 2, color: 0xffffff, vertexColors: THREE.VertexColors} );
	line = new THREE.Line( geometry, material );
	line.computeLineDistances();
	//scene.add( line );


	//advnaced

	 console.log(positions);
	 console.log(colourz);

	 var line_geometry = new THREE.LineGeometry();
	 line_geometry.setPositions(positions);
	 line_geometry.setColors(colourz);


	material2 = new THREE.LineMaterial( { linewidth: 5, color: 0xffffff, vertexColors: THREE.VertexColors, dashed:false } );

	line2 = new THREE.Line2( line_geometry, material2 );

	line2.computeLineDistances();
	line2.scale.set(1,1,1);
	scene.add(line2);


	// light = new THREE.DirectionalLight( 0xffffff );
	// 	  light.position.set( 0, 0, 1 );
	// 	  scene.add( light );
			

	var axesHelper = new THREE.AxesHelper( scale );
	scene.add( axesHelper );


	window.addEventListener( 'resize', onWindowResize, false );
					onWindowResize();

};

function animate () {
				requestAnimationFrame( animate );
				renderer.setClearColor( 0x000000, 0 );
				renderer.setViewport( 0, 0, window.innerWidth, window.innerHeight );

				// renderer will set this eventually
				// material.resolution.set( window.innerWidth, window.innerHeight ); // resolution of the viewport
				material2.resolution.set( window.innerWidth, window.innerHeight ); // resolution of the viewport

				renderer.render(scene, camera);

};

function onWindowResize() {

				camera.aspect = window.innerWidth / window.innerHeight;
				camera.updateProjectionMatrix();

				renderer.setSize( window.innerWidth, window.innerHeight );

			};

</script>
</body>
</html>